# 변경 가능성을 최소화하라

### 불변클래스
- 인스턴스 내부 값을 수정할 수 없는 클래스.
- 가변 클래스보다 설계, 구현 사용이 쉬우며, 오류가 생길 여지도 적고 훨씬 안전하다.
- 규칙
  - 객체의 상태를 변경하는 메서드를 제공하지 않는다.
  - 클래스를 확장할 수 없도록 한다.
  - 모든 필드를 final로 선언한다.
  - 모든 필들르 private으로 선언한다.
  - 자신 외에는 내부의 가변 컴포넌트에 접근할 수 없도록 한다.
- 장점
  - 함수형 프로그래밍에 적합하다.
  - 단순하다.
  - 근본적으로 스레드 안전하여 따로 동기화할 필요가 없다.
  - 안심하고 공유 가능하다.
  - 객체를 만들 때 불변객체로 구성하면 이점이 많다.
  - 실패 원자성을 제공한다.
- 단점
  - "다단계연산"을 제공하거나, "가변 동반 클래스"를 제공하여 대처할 수 있다.
- 불변클래스 만들 때 고려할 것
  - 상속을 막을 수 있는 또 다른 방법
    - private 또는 package-private 생성자 + 정적팩터리 (effectively final)
    - 확장이 가능하다. 다수의 package-private 구현클래스를 만들 수 있다.
    - 정적팩터리를 통해 여러 구현 클래스중 하나를 활용할 수 있는 유연성을 제공하고 객체 캐싱 기능으로 성능을 향상시킬 수도 있다.
  - 재정의가 가능한 클래스는 방어적인 복사를 사용해야 한다.
  - 모든 외부에 공개하는 필드가 final이어야 한다. (계산 비용이 큰 값은 해당 값이 필요로 할 때 계산하여 final이 아닌 필드에 캐시해서 쓸 수도 있다.)
