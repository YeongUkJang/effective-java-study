# 스트림 병렬화는 주의해서 적용하라

### 동시성 프로그래밍
![image](https://github.com/YeongUkJang/effective-java-study/assets/123781240/8787c5b1-3fd9-4593-bb8c-28636bd6d6ae)

### 스트림 병렬화 사용시 고려 사항
  - 스트림 병렬화는 오직 성능 최적화 수단
  - 따라서 성능 테스트를 통해 가치가 있는지 확인할 것
  - 보통은 병렬 스트림 파이프라인도 공통의 포크-조인 풀에서 수행(같은 스레드 풀 사용)되므로 잘못된 파이프라인 하나가 다른 부분의 성능에까지 악영향을 미칠 수 있음

### 스트림 병렬화 문제점
  - 데이터 소스가 Stream.iterate거나 중간 연산으로 limit를 쓰면 파이프라인 병렬화로는 성능 개선을 기대할 수 없다

### 결론
  - 스트림을 잘못 병렬화하면 (응답 불가를 포함해) 성능이 나빠질 뿐만 아니라 결과 자체가 잘못되거나 예상 못한 동작이 발생할 수 있다
  - 데이터 소스가 Stream.iterate거나 중간 연산으로 limit를 쓰면 파이프라인 병렬화로는 성능 개선을 기대할 수 없다
  - 스트림의 소스가 ArrayList, HashMap, HashSet, ConcurrentHashMap의 인스턴스나 배열, int, long 범위일 때 병렬화의 효과가 가장 좋다
  - 단순히 성능이 빨라질꺼라는 확신 없이 파이프라인 병렬화는 시도조차 하지 말아라
